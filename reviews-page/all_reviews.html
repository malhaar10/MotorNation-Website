<!DOCTYPE html>
<html lang="en">

<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5348410100766462"
     crossorigin="anonymous"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MotorNation</title>
    <link rel="icon" type="image/png" href="/assets/miniLogo.avif">
    <link rel="stylesheet" href="../page_header.css">
    <link rel="stylesheet" href="../reviews-page/reviews-home.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="swiper-bundle.min.css">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <script src="../search-functionality.js"></script>
</head>

<body>
    <section class="header">
        <div class="logo-container">
            <a href="../index.html"><img src="../assets/MotorNation.avif" alt="MotorNation Logo"></a>
        </div>
        <nav id="navbar">
            <i class="fa fa-bars" onclick="showMenu()"></i>
            <div class="nav-links" id="navLinks">
                <i class="fa fa-times close-btn" onclick="hideMenu()"></i>
                <ul>
                    <li><a href="../index.html">HOME</a></li>
                    <li><a href="../news-template/news-home.html">NEWS</a></li>
                    <li><a href="../electric/electric.html">ELECTRIC</a></li>
                    <li><a href="../videos/video.html">VIDEOS</a></li>
                    <li><a href="../search.html">SEARCH</a></li>
                </ul>
            </div>
        </nav>
    </section>

    <section class="latest-news">
        <a class="latest-head">ALL REVIEWS</a>
        <div class="container">
            <div class="blog-section">
                <div class="cards" id="all-review-cards">
                    <!-- Cards will be injected here dynamically -->
                </div>
                <button id="loadMoreBtn" class="full-button">Load more</button>
            </div>
        </div>
    </section> 

    <section class="hr">
        <hr>
    </section>
    
    <section class="contact-card">
        <img src="../assets/MotorNation.avif" alt="MotorNation logo">
        <div class="social-icons">
            <a href="https://www.facebook.com/motornationofficial"><i class="fa fa-facebook"></i></a>
            <a href="https://x.com/MotorNation_?t=WVuJZhDNnad4yikXOYNUng&s=09"><i class="fa fa-twitter"></i></a>
            <a href="https://www.instagram.com/motornation_group?igsh=MWJjMGNma3AwMW45Ng=="><i class="fa fa-instagram"></i></a>
            <a href="../assets/youtube.png"><i class="fa fa-youtube"></i></a>
        </div>
        <div class="contact-links">
            <a href="../about_us/about_us.html">About us</a>
            <a href="../contact_us/contact_us.html">Contact us</a>
            <a href="../TnC/tnc.html">Terms & Conditions</a>
            <a href="../careers/careers.html">Careers</a>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const container = document.getElementById('all-review-cards');
            const loadBtn = document.getElementById('loadMoreBtn');
            const initialCount = 12;
            const pageSize = 6;
            let reviews = [];
            let cursor = 0;

            function createCard(r) {
                const card = document.createElement('div');
                card.className = 'card';
                const imageUrl = (r.images && r.images.length > 0) ? r.images[0] : "../images/2025-crv/18_2024HondaCRVEX-L.avif";
                card.innerHTML = `
                    <a href="../reviews-page/review.html?id=${r.id}">
                        <div class="image-section">
                            <img src="${imageUrl}" alt="${r.car_name}" loading="lazy">
                        </div>
                        <div class="content">
                            <p>REVIEW</p>
                            <h3>${r.car_name}</h3>
                            <h5>${r.model_year} â€¢ ${r.tag || ''}${r.tag2 ? ', ' + r.tag2 : ''}</h5>
                            <hr>
                        </div>
                    </a>
                `;
                return card;
            }

            function appendNext(n) {
                const end = Math.min(reviews.length, cursor + n);
                for (let i = cursor; i < end; i++) {
                    container.appendChild(createCard(reviews[i]));
                }
                cursor = end;
                if (cursor >= reviews.length) {
                    loadBtn.style.display = 'none';
                } else {
                    loadBtn.style.display = '';
                }
            }

            try {
                // Use production API like other pages. Replace with relative '/api/reviews' if hosted same origin.
                const resp = await fetch('https://motornation-336079007565.us-central1.run.app/api/reviews');
                if (!resp.ok) throw new Error(`HTTP ${resp.status}: ${resp.statusText}`);
                reviews = await resp.json();
                container.innerHTML = '';

                if (!reviews || reviews.length === 0) {
                    container.innerHTML = '<p>No reviews available.</p>';
                    loadBtn.style.display = 'none';
                    return;
                }

                // initial render (10)
                appendNext(initialCount);

                // click handler to load more (6 each click)
                loadBtn.addEventListener('click', () => appendNext(pageSize));
            } catch (err) {
                console.error('Error loading all reviews:', err);
                container.innerHTML = '<p>Error loading reviews. Try again later.</p>';
                loadBtn.style.display = 'none';
            }
        });
    </script>
</body>


</body>

</html>